<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <style type="text/css">
    .styleA{border:2px dotted gray;}
    .styleB{border:2px dotted rgba(0,200,0,0.7);}
    .styleC{border:2px solid black;}
    </style>
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <title>画像ドラッグ＆ドロッププレビュー</title>
</head>

<body>
<div class="container" id="upload">
    <div class="row m-3">
        <label>配置数：</label>
        <input v-model.number="placements" type="number" min="0" max="100">
    </div>
    <div class="row m-3">
        <label>サイズ：</label>
        <input v-model.number="img_width" type="number">
        <label>×</label>
        <input v-model.number="img_height" type="number">
    </div>
    <div class="row">
        <div v-for="index in [...Array(placements)].map((_, i) => i )" class="col">
        <div class="form-group d-md-inline-block" v-bind:class="{'styleA':styleA[index], 'styleB':styleB[index], 'styleC':styleC[index]}" @dragover.prevent="changeStyle($event,'on',index)" @dragleave.prevent="changeStyle($event,'off',index)" @drop.prevent="uploadFile($event,index)" :style="image_box_style">
            <h3 style="position: absolute;">{{ index + 1 }}</h3>
            <img v-show="previews[index]" v-bind:src="previews[index]" :style="image_style">
        </div>
        <input id="upload_image" type="file" name="img" style="display:none;" accept="image/*">
    </div>
    </div>
</div>

<script>
new Vue({
    el:'#upload',
    data: {
        placements:2,
        previews:Array(100).fill(null),
        styleA:Array(100).fill(true),
        styleB:Array(100).fill(false),
        styleC:Array(100).fill(false),
        count:2,
        img_width:400,
        img_height:400,
    },
    computed: {
        image_box_style: function(){
            return ("width:" + (this.img_width + 4) + "px;") + ("height:" + (this.img_height + 4) + "px;");
        },
        image_style: function(){
            return ("width:" + this.img_width + "px;") + ("height:" + this.img_height + "px;");
        }
    },
    methods: {
        uploadFile: function(event,index){
            this.$set(this.styleA, index, false);
            this.$set(this.styleB, index, false);
            this.$set(this.styleC, index, true);

            const files = event.target.files ? event.target.files : event.dataTransfer.files;
            const file = files[0];
            const reader = new FileReader();
            reader.onload = event => {
                this.previews[index] = event.target.result;
                this.previews = this.previews.map(x => x);
            };
            reader.readAsDataURL(file);
            document.getElementById("upload_image").files = files;
            return;
        },
        changeStyle: function(event,flag,index){
           this.$set(this.styleA, index, flag==='off');
           this.$set(this.styleB, index, flag==='on');
        },
    },
});
</script>

</body>
</html>